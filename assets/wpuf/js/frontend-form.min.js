!function(o,i){o.fn.listautowidth=function(){return this.each(function(){var t=o(this).width()/o(this).children("li").length;o(this).children("li").each(function(){var e=o(this).outerWidth(!0)-o(this).width();o(this).width(t-e)})})},o.fn.extend({weSerialize:function(){return o(this).serialize().replaceAll("%20","+")}}),i.WP_User_Frontend={init:function(){this.enableMultistep(this),o(".wpuf-form").on("click","img.wpuf-clone-field",this.cloneField),o(".wpuf-form").on("click","img.wpuf-remove-field",this.removeField),o(".wpuf-form").on("click","a.wpuf-delete-avatar",this.deleteAvatar),o(".wpuf-form").on("click","a#wpuf-post-draft",this.draftPost),o(".wpuf-form").on("click","button#wpuf-account-update-profile",this.account_update_profile),o(".wpuf-form-add").on("submit",this.formSubmit),o("form#post").on("submit",this.adminPostSubmit),o(".wpuf-form").on("step-change-fieldset",function(e,t,r){if(wpuf_plupload_items.length)for(var n=wpuf_plupload_items.length-1;0<=n;n--)wpuf_plupload_items[n].refresh();if(wpuf_map_items.length)for(n=wpuf_map_items.length-1;0<=n;n--)google.maps.event.trigger(wpuf_map_items[n].map,"resize"),wpuf_map_items[n].map.setCenter(wpuf_map_items[n].center)}),this.ajaxCategory(),o(':submit[name="wpuf_user_subscription_cancel"]').click(function(e){e.preventDefault(),swal({text:wpuf_frontend.cancelSubMsg,type:"warning",showCancelButton:!0,confirmButtonColor:"#d54e21",confirmButtonText:wpuf_frontend.delete_it,cancelButtonText:wpuf_frontend.cancel_it,confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}).then(function(e){if(!e)return!1;o("#wpuf_cancel_subscription").submit()})})},check_pass_strength:function(){var e=o("#pass1").val();if(o("#pass-strength-result").show(),o("#pass-strength-result").removeClass("short bad good strong"),!e)return o("#pass-strength-result").html("&nbsp;"),void o("#pass-strength-result").hide();if(void 0!==wp.passwordStrength)switch(wp.passwordStrength.meter(e,wp.passwordStrength.userInputBlacklist(),e)){case 2:o("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:o("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:o("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:o("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:o("#pass-strength-result").addClass("short").html(pwsL10n.short)}},enableMultistep:function(r){var n=this,a=0,s=o(':hidden[name="wpuf_multistep_type"]').val();if(null!=s){if(o("fieldset.wpuf-multistep-fieldset").find(".wpuf-multistep-prev-btn").first().remove(),o("fieldset.wpuf-multistep-fieldset").find(".wpuf-multistep-next-btn").last().remove(),o(".wpuf-form fieldset").removeClass("field-active").first().addClass("field-active"),"progressive"==s&&0!=o(".wpuf-form .wpuf-multistep-fieldset").length){o("fieldset.wpuf-multistep-fieldset legend").first();o(".wpuf-multistep-progressbar").html('<div class="wpuf-progress-percentage"></div>');var e=o(".wpuf-multistep-progressbar"),t=o(".wpuf-progress-percentage");o(".wpuf-multistep-progressbar").progressbar({change:function(){t.text(e.progressbar("value")+"%")}}),o(".wpuf-multistep-fieldset legend").hide()}else o(".wpuf-form").each(function(){var e=o(this),t=o(".wpuf-multistep-progressbar",e),r="";t.addClass("wizard-steps"),r+='<ul class="wpuf-step-wizard">',o(".wpuf-multistep-fieldset",this).each(function(){r+="<li>"+o.trim(o("legend",this).text())+"</li>",o("legend",this).hide()}),r+="</ul>",t.append(r),o(".wpuf-step-wizard li",t).first().addClass("active-step"),o(".wpuf-step-wizard",t).listautowidth()});this.change_fieldset(a,s),o("fieldset .wpuf-multistep-prev-btn, fieldset .wpuf-multistep-next-btn").click(function(e){o(this).hasClass("wpuf-multistep-next-btn")?0!=n.formStepCheck("",o(this).closest("fieldset"))&&r.change_fieldset(++a,s):o(this).hasClass("wpuf-multistep-prev-btn")&&r.change_fieldset(--a,s);var t=o("form.wpuf-form-add").offset().top;return i.scrollTo({top:t-32,behavior:"smooth"}),!1})}},change_fieldset:function(e,t){var r=o("fieldset.wpuf-multistep-fieldset").eq(e);o("fieldset.wpuf-multistep-fieldset").removeClass("field-active").eq(e).addClass("field-active"),o(".wpuf-step-wizard li").each(function(){o(this).index()<=e?"step_by_step"==t?o(this).addClass("passed-wpuf-ms-bar"):o(".wpuf-ps-bar",this).addClass("passed-wpuf-ms-bar"):"step_by_step"==t?o(this).removeClass("passed-wpuf-ms-bar"):o(".wpuf-ps-bar",this).removeClass("passed-wpuf-ms-bar")}),o(".wpuf-step-wizard li").removeClass("wpuf-ms-bar-active active-step completed-step"),o(".passed-wpuf-ms-bar").addClass("completed-step").last().addClass("wpuf-ms-bar-active"),o(".wpuf-ms-bar-active").addClass("active-step");var n=o("fieldset.wpuf-multistep-fieldset").eq(e).find("legend").text();if(n=o.trim(n),"progressive"==t&&0!=o(".wpuf-form .wpuf-multistep-fieldset").length){var a=100*(e+1)/o("fieldset.wpuf-multistep-fieldset").length;a=Number(a.toFixed(2));o(".wpuf-multistep-progressbar").progressbar({value:a}),o(".wpuf-progress-percentage").text(n+" ("+a+"%)")}o(".wpuf-form").trigger("step-change-fieldset",[e,r])},ajaxCategory:function(){var e=".category-wrap";o(e).on("change",".cat-ajax",function(){currentLevel=parseInt(o(this).parent().attr("level")),WP_User_Frontend.getChildCats(o(this),"lvl",currentLevel+1,e,"category")})},getChildCats:function(t,r,n,e,a){cat=o(t).val(),results_div=r+n,a=void 0!==a?a:"category",field_attr=o(t).siblings("span").data("taxonomy"),o.ajax({type:"post",url:wpuf_frontend.ajaxurl,data:{action:"wpuf_get_child_cat",catID:cat,nonce:wpuf_frontend.nonce,field_attr:field_attr},beforeSend:function(){o(t).parent().parent().next(".loading").addClass("wpuf-loading")},complete:function(){o(t).parent().parent().next(".loading").removeClass("wpuf-loading")},success:function(e){o(t).parent().nextAll().each(function(){o(this).remove()}),""!=e&&(o(t).parent().addClass("hasChild").parent().append('<div id="'+r+n+'" level="'+n+'"></div>'),t.parent().parent().find("#"+results_div).html(e).slideDown("fast"))}})},cloneField:function(e){e.preventDefault();var t=o(this).closest("tr"),r=t.clone();r.find("input").val(""),r.find(":checked").attr("checked",""),t.after(r)},removeField:function(){var e=o(this).closest("tr");1<e.siblings().andSelf().length&&e.remove()},adminPostSubmit:function(e){e.preventDefault();var t=o(this);if(WP_User_Frontend.validateForm(t))return!0},draftPost:function(e){e.preventDefault();var r=o(this),n=o(this).closest("form"),t=n.weSerialize()+"&action=wpuf_draft_post",a=n.find('input[type="hidden"][name="post_id"]').val(),s=[];o(".wpuf-rich-validation").each(function(e,t){var r=(t=o(t)).data("id"),n=t.data("name"),a=o.trim(tinyMCE.get(r).getContent());s.push(n+"="+encodeURIComponent(a))}),t=t+"&"+s.join("&"),r.after(' <span class="wpuf-loading"></span>'),o.post(wpuf_frontend.ajaxurl,t,function(e){if(void 0===a){var t='<input type="hidden" name="post_id" value="'+e.post_id+'">';t+='<input type="hidden" name="post_date" value="'+e.date+'">',t+='<input type="hidden" name="post_author" value="'+e.post_author+'">',t+='<input type="hidden" name="comment_status" value="'+e.comment_status+'">',n.append(t)}r.next("span.wpuf-loading").remove(),r.after('<span class="wpuf-draft-saved">&nbsp; Post Saved</span>'),o(".wpuf-draft-saved").delay(2500).fadeOut("fast",function(){o(this).remove()})})},account_update_profile:function(e){e.preventDefault();var t=o(this).closest("form");o.post(wpuf_frontend.ajaxurl,t.weSerialize(),function(e){e.success?(t.find(".wpuf-error").hide(),t.find(".wpuf-success").show()):(t.find(".wpuf-success").hide(),t.find(".wpuf-error").show(),t.find(".wpuf-error").text(e.data))})},formStepCheck:function(e,t){var r=t;r.find("input[type=submit]");return form_data=WP_User_Frontend.validateForm(r),0==form_data&&WP_User_Frontend.addErrorNotice(self,"bottom"),form_data},formSubmit:function(e){e.preventDefault();var t=o(this),r=t.find("input[type=submit]");form_data=WP_User_Frontend.validateForm(t),form_data&&(t.find("li.wpuf-submit").append('<span class="wpuf-loading"></span>'),r.attr("disabled","disabled").addClass("button-primary-disabled"),o.post(wpuf_frontend.ajaxurl,form_data,function(e){if(e.success)o("body").trigger("wpuf:postform:success",e),1==e.show_message?(t.before('<div class="wpuf-success">'+e.message+"</div>"),t.slideUp("fast",function(){t.remove()}),o("html, body").animate({scrollTop:o(".wpuf-success").offset().top-100},"fast")):i.location=e.redirect_to;else{if(void 0!==e.type&&"login"===e.type)return void(confirm(e.error)?i.location=e.redirect_to:(r.removeAttr("disabled"),r.removeClass("button-primary-disabled"),t.find("span.wpuf-loading").remove()));0<t.find(".g-recaptcha").length&&grecaptcha.reset(),swal({html:e.error,type:"warning",showCancelButton:!1,confirmButtonColor:"#d54e21",confirmButtonText:"OK",cancelButtonClass:"btn btn-danger"}),r.removeAttr("disabled")}r.removeClass("button-primary-disabled"),t.find("span.wpuf-loading").remove()}))},validateForm:function(e){var i=!1;error_type="",WP_User_Frontend.removeErrors(e),WP_User_Frontend.removeErrorNotice(e),e.find('[data-required="yes"]:visible').each(function(e,t){switch(s="",o(t).data("type")){case"rich":var r=o(t).data("id");""===(s=o.trim(tinyMCE.get(r).getContent()))&&(i=!0,WP_User_Frontend.markError(t));break;case"textarea":case"text":""===(s=o.trim(o(t).val()))&&(i=!0,error_type="required",WP_User_Frontend.markError(t,error_type));break;case"password":case"confirm_password":var n=o(t).data("repeat");if(""===(s=o.trim(o(t).val()))&&(i=!0,error_type="required",WP_User_Frontend.markError(t,error_type)),n){var a=o('[data-type="confirm_password"]').eq(0);a.val()!=s&&(i=!0,error_type="mismatch",WP_User_Frontend.markError(a,error_type))}break;case"select":(s=o(t).val())&&"-1"!==s||(i=!0,error_type="required",WP_User_Frontend.markError(t,error_type));break;case"multiselect":null!==(s=o(t).val())&&0!==s.length||(i=!0,error_type="required",WP_User_Frontend.markError(t,error_type));break;case"tax-checkbox":o(t).children().find("input:checked").length||(i=!0,error_type="required",WP_User_Frontend.markError(t,error_type));break;case"radio":o(t).find("input:checked").length||(i=!0,error_type="required",WP_User_Frontend.markError(t,error_type));break;case"file":o(t).find("ul").children().length||(i=!0,error_type="required",WP_User_Frontend.markError(t,error_type));break;case"email":""!==(s=o(t).val())?WP_User_Frontend.isValidEmail(s)||(i=!0,error_type="validation",WP_User_Frontend.markError(t,error_type)):""===s&&(i=!0,error_type="required",WP_User_Frontend.markError(t,error_type));break;case"url":var s;""!==(s=o(t).val())&&(WP_User_Frontend.isValidURL(s)||(i=!0,error_type="validation",WP_User_Frontend.markError(t,error_type)))}});var t=e.find('[data-required="yes"][name="google_map"]');t&&(","==o(t).val()&&(i=!0,error_type="required",WP_User_Frontend.markError(t,error_type)));if(i)return WP_User_Frontend.addErrorNotice(e,"end"),!1;var r=e.weSerialize(),s=[];return o(".wpuf-rich-validation",e).each(function(e,t){var r=(t=o(t)).data("id"),n=t.data("name"),a=o.trim(tinyMCE.get(r).getContent());s.push(n+"="+encodeURIComponent(a))}),r=r+"&"+s.join("&")},addErrorNotice:function(e,t){"bottom"==t?o(".wpuf-multistep-fieldset:visible").append('<div class="wpuf-errors">'+wpuf_frontend.error_message+"</div>"):o(e).find("li.wpuf-submit").append('<div class="wpuf-errors">'+wpuf_frontend.error_message+"</div>")},removeErrorNotice:function(e){o(e).find(".wpuf-errors").remove()},markError:function(e,t){var r="";if(o(e).closest("li").addClass("has-error"),t){switch(r=o(e).closest("li").data("label"),t){case"required":case"mismatch":case"validation":r=r+" "+error_str_obj[t]}o(e).siblings(".wpuf-error-msg").remove(),o(e).after('<div class="wpuf-error-msg">'+r+"</div>")}o(e).focus()},removeErrors:function(e){o(e).find(".has-error").removeClass("has-error"),o(".wpuf-error-msg").remove()},isValidEmail:function(e){return new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(e)},isValidURL:function(e){return new RegExp(/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/).test(e)},insertImage:function(e,s){var n="wpuf-insert-image-container";if(o("#"+e).length){var t=new plupload.Uploader({runtimes:"html5,html4",browse_button:e,container:n,multipart:!0,multipart_params:{action:"wpuf_insert_image",form_id:o("#"+e).data("form_id")},multiple_queues:!1,multi_selection:!1,urlstream_upload:!0,file_data_name:"wpuf_file",max_file_size:"2mb",url:wpuf_frontend_upload.plupload.url,flash_swf_url:wpuf_frontend_upload.flash_swf_url,filters:[{title:"Allowed Files",extensions:"jpg,jpeg,gif,png,bmp"}]});t.bind("Init",function(e,t){}),t.bind("FilesAdded",function(e,t){var r=o("#"+n);o.each(t,function(e,t){r.append('<div class="upload-item" id="'+t.id+'"><div class="progress progress-striped active"><div class="bar"></div></div></div>')}),e.refresh(),e.start()}),t.bind("QueueChanged",function(e){t.start()}),t.bind("UploadProgress",function(e,t){var r=o("#"+t.id);o(".bar",r).css({width:t.percent+"%"}),o(".percent",r).html(t.percent+"%")}),t.bind("Error",function(e,t){alert("Error #"+t.code+": "+t.message)}),t.bind("FileUploaded",function(e,t,r){if(o("#"+t.id).remove(),"error"!==r.response){if("undefined"!=typeof tinyMCE)if("function"!=typeof tinyMCE.execInstanceCommand){var n=tinyMCE.get("post_content_"+s);null!==n&&n.insertContent(r.response)}else tinyMCE.execInstanceCommand("post_content_"+s,"mceInsertContent",!1,r.response);var a=o("#post_content_"+s);a.val(a.val()+r.response)}else alert("Something went wrong")}),t.init()}},deleteAvatar:function(e){e.preventDefault(),confirm(o(this).data("confirm"))&&o.post(wpuf_frontend.ajaxurl,{action:"wpuf_delete_avatar",_wpnonce:wpuf_frontend.nonce},function(){o(e.target).parent().remove(),o("[id^=wpuf-avatar]").css("display","")})},editorLimit:{bind:function(r,e,t){"no"===t?(o("textarea#"+e).keydown(function(e){WP_User_Frontend.editorLimit.textLimit.call(this,e,r)}),o("input#"+e).keydown(function(e){WP_User_Frontend.editorLimit.textLimit.call(this,e,r)}),o("textarea#"+e).on("paste",function(e){var t=o(this);setTimeout(function(){WP_User_Frontend.editorLimit.textLimit.call(t,e,r)},100)}),o("input#"+e).on("paste",function(e){var t=o(this);setTimeout(function(){WP_User_Frontend.editorLimit.textLimit.call(t,e,r)},100)})):setTimeout(function(){tinyMCE.get(e).onKeyDown.add(function(e,t){WP_User_Frontend.editorLimit.tinymce.onKeyDown(e,t,r)}),tinyMCE.get(e).onPaste.add(function(e,t){setTimeout(function(){WP_User_Frontend.editorLimit.tinymce.onPaste(e,t,r)},100)})},1e3)},tinymce:{getStats:function(e){var t=e.getBody(),r=tinymce.trim(t.innerText||t.textContent);return{chars:r.length,words:r.split(/[\w\u2019\'-]+/).length}},onKeyDown:function(e,t,r){var n=WP_User_Frontend.editorLimit.tinymce.getStats(e).words-1;r&&o(".mce-path-item.mce-last",e.container).html("Word Limit : "+n+"/"+r),r&&r<n&&(WP_User_Frontend.editorLimit.blockTyping(t),jQuery(".mce-path-item.mce-last",e.container).html(wpuf_frontend.word_limit))},onPaste:function(e,t,r){var n=e.getContent().split(" ").slice(0,r).join(" ");e.setContent(n),WP_User_Frontend.editorLimit.make_media_embed_code(n,e)}},textLimit:function(e,t){var r=o(this),n=r.val().split(" ");t&&n.length>t?(r.closest(".wpuf-fields").find("span.wpuf-wordlimit-message").html(wpuf_frontend.word_limit),WP_User_Frontend.editorLimit.blockTyping(e)):r.closest(".wpuf-fields").find("span.wpuf-wordlimit-message").html(""),"paste"===e.type&&r.val(n.slice(0,t).join(" "))},blockTyping:function(e){-1!==o.inArray(e.keyCode,[46,8,9,27,13,110,190,189])||65==e.keyCode&&!0===e.ctrlKey||35<=e.keyCode&&e.keyCode<=40||(e.preventDefault(),e.stopPropagation())},make_media_embed_code:function(e,t){o.post(ajaxurl,{action:"make_media_embed_code",content:e},function(e){t.setContent(t.getContent()+t.setContent(e))})}}},o(function(){(WP_User_Frontend.init(),o("ul.wpuf-payment-gateways").on("click","input[type=radio]",function(e){o(".wpuf-payment-instruction").slideUp(250),o(this).parents("li").find(".wpuf-payment-instruction").slideDown(250)}),o("ul.wpuf-payment-gateways li").find("input[type=radio]").is(":checked"))?o("ul.wpuf-payment-gateways li").find("input[type=radio]:checked").parents("li").find(".wpuf-payment-instruction").slideDown(250):o("ul.wpuf-payment-gateways li").first().find("input[type=radio]").click()}),o(function(){o('input[name="first_name"], input[name="last_name"]').on("change keyup",function(){var e,t=o.makeArray(o('input[name="first_name"], input[name="last_name"]').map(function(){if(e=o(this).val())return e})).join(" ");o('input[name="display_name"]').val(t)})}),o(function(r){r('.wpuf-form-add input[name="dokan_store_name"]').on("focusout",function(){var e=r(this).val().toLowerCase().replace(/-+/g,"").replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");r('input[name="shopurl"]').val(e),r("#url-alart").text(e),r('input[name="shopurl"]').focus()}),r('.wpuf-form-add input[name="shopurl"]').keydown(function(e){r(this).val();-1!==r.inArray(e.keyCode,[46,8,9,27,13,91,109,110,173,189,190])||65==e.keyCode&&!0===e.ctrlKey||35<=e.keyCode&&e.keyCode<=39||(e.shiftKey||(e.keyCode<65||90<e.keyCode)&&(e.keyCode<48||57<e.keyCode))&&(e.keyCode<96||105<e.keyCode)&&e.preventDefault()}),r('.wpuf-form-add input[name="shopurl"]').keyup(function(e){r("#url-alart").text(r(this).val())}),r('.wpuf-form-add input[name="shopurl"]').on("focusout",function(){var e=r(this),t={action:"shop_url",url_slug:e.val(),_nonce:dokan.nonce};""!==e.val()&&r.post(dokan.ajaxurl,t,function(e){0==e?(r("#url-alart").removeClass("text-success").addClass("text-danger"),r("#url-alart-mgs").removeClass("text-success").addClass("text-danger").text(dokan.seller.notAvailable)):(r("#url-alart").removeClass("text-danger").addClass("text-success"),r("#url-alart-mgs").removeClass("text-danger").addClass("text-success").text(dokan.seller.available))})}),r(".wpuf-form-add #wpuf-map-add-location").attr("name","find_address")})}(jQuery,window);