!function(e,t){e.fn.listautowidth=function(){return this.each(function(){var t=e(this).width()/e(this).children("li").length;e(this).children("li").each(function(){var r=e(this).outerWidth(!0)-e(this).width();e(this).width(t-r)})})},t.WP_User_Frontend={init:function(){this.enableMultistep(this),e(".wpuf-form").on("click","img.wpuf-clone-field",this.cloneField),e(".wpuf-form").on("click","img.wpuf-remove-field",this.removeField),e(".wpuf-form").on("click","a.wpuf-delete-avatar",this.deleteAvatar),e(".wpuf-form").on("click","a#wpuf-post-draft",this.draftPost),e(".wpuf-form").on("click","button#wpuf-account-update-profile",this.account_update_profile),e(".wpuf-form-add").on("submit",this.formSubmit),e("form#post").on("submit",this.adminPostSubmit),e(".wpuf-form").on("step-change-fieldset",function(e,t,r){if(wpuf_plupload_items.length)for(var n=wpuf_plupload_items.length-1;n>=0;n--)wpuf_plupload_items[n].refresh();if(wpuf_map_items.length)for(n=wpuf_map_items.length-1;n>=0;n--)google.maps.event.trigger(wpuf_map_items[n].map,"resize"),wpuf_map_items[n].map.setCenter(wpuf_map_items[n].center)}),this.ajaxCategory(),e(':submit[name="wpuf_user_subscription_cancel"]').click(function(t){t.preventDefault(),swal({text:wpuf_frontend.cancelSubMsg,type:"warning",showCancelButton:!0,confirmButtonColor:"#d54e21",confirmButtonText:wpuf_frontend.delete_it,cancelButtonText:wpuf_frontend.cancel_it,confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}).then(function(t){if(!t)return!1;e("#wpuf_cancel_subscription").submit()})})},check_pass_strength:function(){var t=e("#pass1").val();if(e("#pass-strength-result").show(),e("#pass-strength-result").removeClass("short bad good strong"),!t)return e("#pass-strength-result").html("&nbsp;"),void e("#pass-strength-result").hide();if(void 0!==wp.passwordStrength)switch(wp.passwordStrength.meter(t,wp.passwordStrength.userInputBlacklist(),t)){case 2:e("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:e("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:e("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:e("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:e("#pass-strength-result").addClass("short").html(pwsL10n.short)}},enableMultistep:function(r){var n=this,a=0,s=e(':hidden[name="wpuf_multistep_type"]').val();if(null!=s){if(e("fieldset.wpuf-multistep-fieldset").find(".wpuf-multistep-prev-btn").first().remove(),e("fieldset.wpuf-multistep-fieldset").find(".wpuf-multistep-next-btn").last().remove(),e(".wpuf-form fieldset").removeClass("field-active").first().addClass("field-active"),"progressive"==s&&0!=e(".wpuf-form .wpuf-multistep-fieldset").length){e("fieldset.wpuf-multistep-fieldset legend").first();e(".wpuf-multistep-progressbar").html('<div class="wpuf-progress-percentage"></div>');var i=e(".wpuf-multistep-progressbar"),o=e(".wpuf-progress-percentage");e(".wpuf-multistep-progressbar").progressbar({change:function(){o.text(i.progressbar("value")+"%")}}),e(".wpuf-multistep-fieldset legend").hide()}else e(".wpuf-form").each(function(){var t=e(this),r=e(".wpuf-multistep-progressbar",t),n="";r.addClass("wizard-steps"),n+='<ul class="wpuf-step-wizard">',e(".wpuf-multistep-fieldset",this).each(function(){n+="<li>"+e.trim(e("legend",this).text())+"</li>",e("legend",this).hide()}),n+="</ul>",r.append(n),e(".wpuf-step-wizard li",r).first().addClass("active-step"),e(".wpuf-step-wizard",r).listautowidth()});this.change_fieldset(a,s),e("fieldset .wpuf-multistep-prev-btn, fieldset .wpuf-multistep-next-btn").click(function(i){if(e(this).hasClass("wpuf-multistep-next-btn")){0!=n.formStepCheck("",e(this).closest("fieldset"))&&r.change_fieldset(++a,s)}else e(this).hasClass("wpuf-multistep-prev-btn")&&r.change_fieldset(--a,s);var o=e("form.wpuf-form-add").offset().top;return t.scrollTo({top:o-32,behavior:"smooth"}),!1})}},change_fieldset:function(t,r){var n=e("fieldset.wpuf-multistep-fieldset").eq(t);e("fieldset.wpuf-multistep-fieldset").removeClass("field-active").eq(t).addClass("field-active"),e(".wpuf-step-wizard li").each(function(){e(this).index()<=t?"step_by_step"==r?e(this).addClass("passed-wpuf-ms-bar"):e(".wpuf-ps-bar",this).addClass("passed-wpuf-ms-bar"):"step_by_step"==r?e(this).removeClass("passed-wpuf-ms-bar"):e(".wpuf-ps-bar",this).removeClass("passed-wpuf-ms-bar")}),e(".wpuf-step-wizard li").removeClass("wpuf-ms-bar-active active-step completed-step"),e(".passed-wpuf-ms-bar").addClass("completed-step").last().addClass("wpuf-ms-bar-active"),e(".wpuf-ms-bar-active").addClass("active-step");var a=e("fieldset.wpuf-multistep-fieldset").eq(t).find("legend").text();if(a=e.trim(a),"progressive"==r&&0!=e(".wpuf-form .wpuf-multistep-fieldset").length){var s=100*(t+1)/e("fieldset.wpuf-multistep-fieldset").length;s=Number(s.toFixed(2));e(".wpuf-multistep-progressbar").progressbar({value:s}),e(".wpuf-progress-percentage").text(a+" ("+s+"%)")}e(".wpuf-form").trigger("step-change-fieldset",[t,n])},ajaxCategory:function(){e(".category-wrap").on("change",".cat-ajax",function(){currentLevel=parseInt(e(this).parent().attr("level")),WP_User_Frontend.getChildCats(e(this),"lvl",currentLevel+1,".category-wrap","category")})},getChildCats:function(t,r,n,a,s){cat=e(t).val(),results_div=r+n,s=void 0!==s?s:"category",field_attr=e(t).siblings("span").data("taxonomy"),e.ajax({type:"post",url:wpuf_frontend.ajaxurl,data:{action:"wpuf_get_child_cat",catID:cat,nonce:wpuf_frontend.nonce,field_attr:field_attr},beforeSend:function(){e(t).parent().parent().next(".loading").addClass("wpuf-loading")},complete:function(){e(t).parent().parent().next(".loading").removeClass("wpuf-loading")},success:function(a){e(t).parent().nextAll().each(function(){e(this).remove()}),""!=a&&(e(t).parent().addClass("hasChild").parent().append('<div id="'+r+n+'" level="'+n+'"></div>'),t.parent().parent().find("#"+results_div).html(a).slideDown("fast"))}})},cloneField:function(t){t.preventDefault();var r=e(this).closest("tr"),n=r.clone();n.find("input").val(""),n.find(":checked").attr("checked",""),r.after(n)},removeField:function(){var t=e(this).closest("tr");t.siblings().andSelf().length>1&&t.remove()},adminPostSubmit:function(t){t.preventDefault();var r=e(this);if(WP_User_Frontend.validateForm(r))return!0},draftPost:function(t){t.preventDefault();var r=e(this),n=e(this).closest("form"),a=n.serialize()+"&action=wpuf_draft_post",s=n.find('input[type="hidden"][name="post_id"]').val(),i=[];e(".wpuf-rich-validation").each(function(t,r){var n=(r=e(r)).data("id"),a=r.data("name"),s=e.trim(tinyMCE.get(n).getContent());i.push(a+"="+encodeURIComponent(s))}),a=a+"&"+i.join("&"),r.after(' <span class="wpuf-loading"></span>'),e.post(wpuf_frontend.ajaxurl,a,function(t){if(void 0===s){var a='<input type="hidden" name="post_id" value="'+t.post_id+'">';a+='<input type="hidden" name="post_date" value="'+t.date+'">',a+='<input type="hidden" name="post_author" value="'+t.post_author+'">',a+='<input type="hidden" name="comment_status" value="'+t.comment_status+'">',n.append(a)}r.next("span.wpuf-loading").remove(),r.after('<span class="wpuf-draft-saved">&nbsp; Post Saved</span>'),e(".wpuf-draft-saved").delay(2500).fadeOut("fast",function(){e(this).remove()})})},account_update_profile:function(t){t.preventDefault();var r=e(this).closest("form");e.post(wpuf_frontend.ajaxurl,r.serialize(),function(e){e.success?(r.find(".wpuf-error").hide(),r.find(".wpuf-success").show()):(r.find(".wpuf-success").hide(),r.find(".wpuf-error").show(),r.find(".wpuf-error").text(e.data))})},formStepCheck:function(e,t){var r=t;r.find("input[type=submit]");return form_data=WP_User_Frontend.validateForm(r),0==form_data&&WP_User_Frontend.addErrorNotice(self,"bottom"),form_data},formSubmit:function(r){r.preventDefault();var n=e(this),a=n.find("input[type=submit]");form_data=WP_User_Frontend.validateForm(n),form_data&&(n.find("li.wpuf-submit").append('<span class="wpuf-loading"></span>'),a.attr("disabled","disabled").addClass("button-primary-disabled"),e.post(wpuf_frontend.ajaxurl,form_data,function(r){if(r.success)e("body").trigger("wpuf:postform:success",r),1==r.show_message?(n.before('<div class="wpuf-success">'+r.message+"</div>"),n.slideUp("fast",function(){n.remove()}),e("html, body").animate({scrollTop:e(".wpuf-success").offset().top-100},"fast")):t.location=r.redirect_to;else{if(void 0!==r.type&&"login"===r.type)return void(confirm(r.error)?t.location=r.redirect_to:(a.removeAttr("disabled"),a.removeClass("button-primary-disabled"),n.find("span.wpuf-loading").remove()));n.find(".g-recaptcha").length>0&&grecaptcha.reset(),swal({html:r.error,type:"warning",showCancelButton:!1,confirmButtonColor:"#d54e21",confirmButtonText:"OK",cancelButtonClass:"btn btn-danger"}),a.removeAttr("disabled")}a.removeClass("button-primary-disabled"),n.find("span.wpuf-loading").remove()}))},validateForm:function(t){var r=!1;error_type="",WP_User_Frontend.removeErrors(t),WP_User_Frontend.removeErrorNotice(t);t.find('[data-required="yes"]:visible').each(function(t,n){switch(o="",e(n).data("type")){case"rich":var a=e(n).data("id");""===(o=e.trim(tinyMCE.get(a).getContent()))&&(r=!0,WP_User_Frontend.markError(n));break;case"textarea":case"text":""===(o=e.trim(e(n).val()))&&(r=!0,error_type="required",WP_User_Frontend.markError(n,error_type));break;case"password":case"confirm_password":var s=e(n).data("repeat");if(""===(o=e.trim(e(n).val()))&&(r=!0,error_type="required",WP_User_Frontend.markError(n,error_type)),s){var i=e('[data-type="confirm_password"]').eq(0);i.val()!=o&&(r=!0,error_type="mismatch",WP_User_Frontend.markError(i,error_type))}break;case"select":(o=e(n).val())&&"-1"!==o||(r=!0,error_type="required",WP_User_Frontend.markError(n,error_type));break;case"multiselect":null!==(o=e(n).val())&&0!==o.length||(r=!0,error_type="required",WP_User_Frontend.markError(n,error_type));break;case"tax-checkbox":e(n).children().find("input:checked").length||(r=!0,error_type="required",WP_User_Frontend.markError(n,error_type));break;case"radio":e(n).find("input:checked").length||(r=!0,error_type="required",WP_User_Frontend.markError(n,error_type));break;case"file":e(n).find("ul").children().length||(r=!0,error_type="required",WP_User_Frontend.markError(n,error_type));break;case"email":""!==(o=e(n).val())?WP_User_Frontend.isValidEmail(o)||(r=!0,error_type="validation",WP_User_Frontend.markError(n,error_type)):""===o&&(r=!0,error_type="required",WP_User_Frontend.markError(n,error_type));break;case"url":var o;""!==(o=e(n).val())&&(WP_User_Frontend.isValidURL(o)||(r=!0,error_type="validation",WP_User_Frontend.markError(n,error_type)))}});var n=t.find('[data-required="yes"][name="google_map"]');if(n){","==e(n).val()&&(r=!0,error_type="required",WP_User_Frontend.markError(n,error_type))}if(r)return WP_User_Frontend.addErrorNotice(t,"end"),!1;var a=t.serialize(),s=[];return e(".wpuf-rich-validation",t).each(function(t,r){var n=(r=e(r)).data("id"),a=r.data("name"),i=e.trim(tinyMCE.get(n).getContent());s.push(a+"="+encodeURIComponent(i))}),a=a+"&"+s.join("&")},addErrorNotice:function(t,r){"bottom"==r?e(".wpuf-multistep-fieldset:visible").append('<div class="wpuf-errors">'+wpuf_frontend.error_message+"</div>"):e(t).find("li.wpuf-submit").append('<div class="wpuf-errors">'+wpuf_frontend.error_message+"</div>")},removeErrorNotice:function(t){e(t).find(".wpuf-errors").remove()},markError:function(t,r){var n="";if(e(t).closest("li").addClass("has-error"),r){switch(n=e(t).closest("li").data("label"),r){case"required":case"mismatch":case"validation":n=n+" "+error_str_obj[r]}e(t).siblings(".wpuf-error-msg").remove(),e(t).after('<div class="wpuf-error-msg">'+n+"</div>")}e(t).focus()},removeErrors:function(t){e(t).find(".has-error").removeClass("has-error"),e(".wpuf-error-msg").remove()},isValidEmail:function(e){return new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(e)},isValidURL:function(e){return new RegExp("^(http://www.|https://www.|ftp://www.|www.|http://|https://){1}([0-9A-Za-z]+.)").test(e)},insertImage:function(t,r){var n="wpuf-insert-image-container";if(e("#"+t).length){var a=new plupload.Uploader({runtimes:"html5,html4",browse_button:t,container:n,multipart:!0,multipart_params:{action:"wpuf_insert_image",form_id:e("#"+t).data("form_id")},multiple_queues:!1,multi_selection:!1,urlstream_upload:!0,file_data_name:"wpuf_file",max_file_size:"2mb",url:wpuf_frontend_upload.plupload.url,flash_swf_url:wpuf_frontend_upload.flash_swf_url,filters:[{title:"Allowed Files",extensions:"jpg,jpeg,gif,png,bmp"}]});a.bind("Init",function(e,t){}),a.bind("FilesAdded",function(t,r){var a=e("#"+n);e.each(r,function(e,t){a.append('<div class="upload-item" id="'+t.id+'"><div class="progress progress-striped active"><div class="bar"></div></div></div>')}),t.refresh(),t.start()}),a.bind("QueueChanged",function(e){a.start()}),a.bind("UploadProgress",function(t,r){var n=e("#"+r.id);e(".bar",n).css({width:r.percent+"%"}),e(".percent",n).html(r.percent+"%")}),a.bind("Error",function(e,t){alert("Error #"+t.code+": "+t.message)}),a.bind("FileUploaded",function(t,n,a){if(e("#"+n.id).remove(),"error"!==a.response){if("undefined"!=typeof tinyMCE)if("function"!=typeof tinyMCE.execInstanceCommand){var s=tinyMCE.get("post_content_"+r);null!==s&&s.insertContent(a.response)}else tinyMCE.execInstanceCommand("post_content_"+r,"mceInsertContent",!1,a.response);var i=e("#post_content_"+r);i.val(i.val()+a.response)}else alert("Something went wrong")}),a.init()}},deleteAvatar:function(t){t.preventDefault(),confirm(e(this).data("confirm"))&&e.post(wpuf_frontend.ajaxurl,{action:"wpuf_delete_avatar",_wpnonce:wpuf_frontend.nonce},function(){e(t.target).parent().remove(),e("[id^=wpuf-avatar]").css("display","")})},editorLimit:{bind:function(t,r,n){"no"===n?(e("textarea#"+r).keydown(function(e){WP_User_Frontend.editorLimit.textLimit.call(this,e,t)}),e("input#"+r).keydown(function(e){WP_User_Frontend.editorLimit.textLimit.call(this,e,t)}),e("textarea#"+r).on("paste",function(r){var n=e(this);setTimeout(function(){WP_User_Frontend.editorLimit.textLimit.call(n,r,t)},100)}),e("input#"+r).on("paste",function(r){var n=e(this);setTimeout(function(){WP_User_Frontend.editorLimit.textLimit.call(n,r,t)},100)})):setTimeout(function(){tinyMCE.get(r).onKeyDown.add(function(e,r){WP_User_Frontend.editorLimit.tinymce.onKeyDown(e,r,t)}),tinyMCE.get(r).onPaste.add(function(e,r){setTimeout(function(){WP_User_Frontend.editorLimit.tinymce.onPaste(e,r,t)},100)})},1e3)},tinymce:{getStats:function(e){var t=e.getBody(),r=tinymce.trim(t.innerText||t.textContent);return{chars:r.length,words:r.split(/[\w\u2019\'-]+/).length}},onKeyDown:function(t,r,n){var a=WP_User_Frontend.editorLimit.tinymce.getStats(t).words-1;n&&e(".mce-path-item.mce-last",t.container).html("Word Limit : "+a+"/"+n),n&&a>n&&(WP_User_Frontend.editorLimit.blockTyping(r),jQuery(".mce-path-item.mce-last",t.container).html(wpuf_frontend.word_limit))},onPaste:function(e,t,r){var n=e.getContent().split(" ").slice(0,r).join(" ");e.setContent(n),WP_User_Frontend.editorLimit.make_media_embed_code(n,e)}},textLimit:function(t,r){var n=e(this),a=n.val().split(" ");r&&a.length>r?(n.closest(".wpuf-fields").find("span.wpuf-wordlimit-message").html(wpuf_frontend.word_limit),WP_User_Frontend.editorLimit.blockTyping(t)):n.closest(".wpuf-fields").find("span.wpuf-wordlimit-message").html(""),"paste"===t.type&&n.val(a.slice(0,r).join(" "))},blockTyping:function(t){-1!==e.inArray(t.keyCode,[46,8,9,27,13,110,190,189])||65==t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=40||(t.preventDefault(),t.stopPropagation())},make_media_embed_code:function(t,r){e.post(ajaxurl,{action:"make_media_embed_code",content:t},function(e){r.setContent(r.getContent()+r.setContent(e))})}}},e(function(){if(WP_User_Frontend.init(),e("ul.wpuf-payment-gateways").on("click","input[type=radio]",function(t){e(".wpuf-payment-instruction").slideUp(250),e(this).parents("li").find(".wpuf-payment-instruction").slideDown(250)}),e("ul.wpuf-payment-gateways li").find("input[type=radio]").is(":checked")){e("ul.wpuf-payment-gateways li").find("input[type=radio]:checked").parents("li").find(".wpuf-payment-instruction").slideDown(250)}else e("ul.wpuf-payment-gateways li").first().find("input[type=radio]").click()}),e(function(){e('input[name="first_name"], input[name="last_name"]').on("change keyup",function(){var t,r=e.makeArray(e('input[name="first_name"], input[name="last_name"]').map(function(){if(t=e(this).val())return t})).join(" ");e('input[name="display_name"]').val(r)})}),e(function(e){e('.wpuf-form-add input[name="dokan_store_name"]').on("focusout",function(){var t=e(this).val().toLowerCase().replace(/-+/g,"").replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");e('input[name="shopurl"]').val(t),e("#url-alart").text(t),e('input[name="shopurl"]').focus()}),e('.wpuf-form-add input[name="shopurl"]').keydown(function(t){e(this).val();-1!==e.inArray(t.keyCode,[46,8,9,27,13,91,109,110,173,189,190])||65==t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=39||(t.shiftKey||(t.keyCode<65||t.keyCode>90)&&(t.keyCode<48||t.keyCode>57))&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}),e('.wpuf-form-add input[name="shopurl"]').keyup(function(t){e("#url-alart").text(e(this).val())}),e('.wpuf-form-add input[name="shopurl"]').on("focusout",function(){var t=e(this),r={action:"shop_url",url_slug:t.val(),_nonce:dokan.nonce};""!==t.val()&&e.post(dokan.ajaxurl,r,function(t){0==t?(e("#url-alart").removeClass("text-success").addClass("text-danger"),e("#url-alart-mgs").removeClass("text-success").addClass("text-danger").text(dokan.seller.notAvailable)):(e("#url-alart").removeClass("text-danger").addClass("text-success"),e("#url-alart-mgs").removeClass("text-danger").addClass("text-success").text(dokan.seller.available))})}),e(".wpuf-form-add #wpuf-map-add-location").attr("name","find_address")})}(jQuery,window);